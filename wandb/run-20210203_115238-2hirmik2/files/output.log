Not using distributed mode
git:
  sha: a54b77800eb8e64e3ad0d8237789fcbf2f8350c5, status: has uncommited changes, branch: master

Namespace(aux_loss=True, backbone='resnet50', batch_size=4, bbox_loss_coef=5, clip_max_norm=0.1, coco_panoptic_path=None, coco_path='../../dataset/', dataset_file='coco', dec_layers=6, device='cuda', dice_loss_coef=1, dilation=False, dim_feedforward=2048, dist_url='env://', distributed=False, dropout=0.1, enc_layers=6, eos_coef=0.1, epochs=20, eval=False, frozen_weights=None, giou_loss_coef=2, hidden_dim=256, lr=0.0001, lr_backbone=1e-05, lr_drop=200, mask_loss_coef=1, masks=False, nheads=8, num_queries=50, num_workers=2, output_dir='Adam_output', position_embedding='sine', pre_norm=False, remove_difficult=False, resume='', seed=42, set_cost_bbox=5, set_cost_class=1, set_cost_giou=2, start_epoch=0, weight_decay=0.0001, world_size=1)
number of params: 41266438
loading annotations into memory...
Done (t=0.99s)
creating index...
index created!
loading annotations into memory...
Done (t=0.06s)
creating index...
index created!
Start training
Epoch: [0]  [   0/3756]  eta: 0:48:06  lr: 0.001000  class_error: 58.54  loss: 57.0384 (57.0384)  loss_ce: 0.7133 (0.7133)  loss_bbox: 6.5913 (6.5913)  loss_giou: 2.3437 (2.3437)  loss_ce_0: 0.5794 (0.5794)  loss_bbox_0: 6.6160 (6.6160)  loss_giou_0: 2.3278 (2.3278)  loss_ce_1: 0.5477 (0.5477)  loss_bbox_1: 6.4310 (6.4310)  loss_giou_1: 2.3182 (2.3182)  loss_ce_2: 0.5597 (0.5597)  loss_bbox_2: 6.5922 (6.5922)  loss_giou_2: 2.3433 (2.3433)  loss_ce_3: 0.5488 (0.5488)  loss_bbox_3: 6.5945 (6.5945)  loss_giou_3: 2.3439 (2.3439)  loss_ce_4: 0.7559 (0.7559)  loss_bbox_4: 6.4578 (6.4578)  loss_giou_4: 2.3740 (2.3740)  loss_ce_unscaled: 0.7133 (0.7133)  class_error_unscaled: 58.5366 (58.5366)  loss_bbox_unscaled: 1.3183 (1.3183)  loss_giou_unscaled: 1.1718 (1.1718)  cardinality_error_unscaled: 12.2500 (12.2500)  loss_ce_0_unscaled: 0.5794 (0.5794)  loss_bbox_0_unscaled: 1.3232 (1.3232)  loss_giou_0_unscaled: 1.1639 (1.1639)  cardinality_error_0_unscaled: 39.7500 (39.7500)  loss_ce_1_unscaled: 0.5477 (0.5477)  loss_bbox_1_unscaled: 1.2862 (1.2862)  loss_giou_1_unscaled: 1.1591 (1.1591)  cardinality_error_1_unscaled: 38.5000 (38.5000)  loss_ce_2_unscaled: 0.5597 (0.5597)  loss_bbox_2_unscaled: 1.3184 (1.3184)  loss_giou_2_unscaled: 1.1717 (1.1717)  cardinality_error_2_unscaled: 25.2500 (25.2500)  loss_ce_3_unscaled: 0.5488 (0.5488)  loss_bbox_3_unscaled: 1.3189 (1.3189)  loss_giou_3_unscaled: 1.1719 (1.1719)  cardinality_error_3_unscaled: 30.5000 (30.5000)  loss_ce_4_unscaled: 0.7559 (0.7559)  loss_bbox_4_unscaled: 1.2916 (1.2916)  loss_giou_4_unscaled: 1.1870 (1.1870)  cardinality_error_4_unscaled: 9.0000 (9.0000)  time: 0.7686  data: 0.2829  max mem: 2262
Epoch: [0]  [  10/3756]  eta: 0:32:19  lr: 0.001000  class_error: 0.00  loss: 41.3007 (44.9383)  loss_ce: 0.7236 (1.0321)  loss_bbox: 2.5919 (3.3451)  loss_giou: 3.3413 (3.1530)  loss_ce_0: 0.7254 (0.9762)  loss_bbox_0: 2.7674 (3.3750)  loss_giou_0: 3.2762 (3.1374)  loss_ce_1: 0.7278 (1.0637)  loss_bbox_1: 2.6541 (3.3253)  loss_giou_1: 3.2826 (3.1481)  loss_ce_2: 0.6500 (0.9778)  loss_bbox_2: 2.5938 (3.2999)  loss_giou_2: 3.3523 (3.1643)  loss_ce_3: 0.7003 (0.9733)  loss_bbox_3: 2.6152 (3.3109)  loss_giou_3: 3.3557 (3.1682)  loss_ce_4: 0.7443 (0.9921)  loss_bbox_4: 2.6693 (3.3327)  loss_giou_4: 3.3276 (3.1631)  loss_ce_unscaled: 0.7236 (1.0321)  class_error_unscaled: 0.0000 (26.1771)  loss_bbox_unscaled: 0.5184 (0.6690)  loss_giou_unscaled: 1.6707 (1.5765)  cardinality_error_unscaled: 42.0000 (30.8636)  loss_ce_0_unscaled: 0.7254 (0.9762)  loss_bbox_0_unscaled: 0.5535 (0.6750)  loss_giou_0_unscaled: 1.6381 (1.5687)  cardinality_error_0_unscaled: 39.7500 (26.6591)  loss_ce_1_unscaled: 0.7278 (1.0637)  loss_bbox_1_unscaled: 0.5308 (0.6651)  loss_giou_1_unscaled: 1.6413 (1.5741)  cardinality_error_1_unscaled: 38.5000 (27.2727)  loss_ce_2_unscaled: 0.6500 (0.9778)  loss_bbox_2_unscaled: 0.5188 (0.6600)  loss_giou_2_unscaled: 1.6761 (1.5822)  cardinality_error_2_unscaled: 34.7500 (33.1136)  loss_ce_3_unscaled: 0.7003 (0.9733)  loss_bbox_3_unscaled: 0.5230 (0.6622)  loss_giou_3_unscaled: 1.6779 (1.5841)  cardinality_error_3_unscaled: 42.2500 (34.4545)  loss_ce_4_unscaled: 0.7443 (0.9921)  loss_bbox_4_unscaled: 0.5339 (0.6665)  loss_giou_4_unscaled: 1.6638 (1.5816)  cardinality_error_4_unscaled: 42.0000 (30.5909)  time: 0.5176  data: 0.0344  max mem: 3972
Epoch: [0]  [  20/3756]  eta: 0:31:02  lr: 0.001000  class_error: 0.00  loss: 39.3665 (41.5735)  loss_ce: 0.6857 (0.8729)  loss_bbox: 2.3114 (2.7738)  loss_giou: 3.5002 (3.3272)  loss_ce_0: 0.6988 (0.8365)  loss_bbox_0: 2.3820 (2.8000)  loss_giou_0: 3.5016 (3.3296)  loss_ce_1: 0.6678 (0.8868)  loss_bbox_1: 2.3294 (2.7324)  loss_giou_1: 3.4679 (3.3105)  loss_ce_2: 0.6594 (0.8300)  loss_bbox_2: 2.2676 (2.7243)  loss_giou_2: 3.4400 (3.3195)  loss_ce_3: 0.6807 (0.8332)  loss_bbox_3: 2.2241 (2.7405)  loss_giou_3: 3.4761 (3.3270)  loss_ce_4: 0.6884 (0.8459)  loss_bbox_4: 2.2567 (2.7539)  loss_giou_4: 3.4753 (3.3296)  loss_ce_unscaled: 0.6857 (0.8729)  class_error_unscaled: 0.0000 (38.5219)  loss_bbox_unscaled: 0.4623 (0.5548)  loss_giou_unscaled: 1.7501 (1.6636)  cardinality_error_unscaled: 37.7500 (26.0357)  loss_ce_0_unscaled: 0.6988 (0.8365)  loss_bbox_0_unscaled: 0.4764 (0.5600)  loss_giou_0_unscaled: 1.7508 (1.6648)  cardinality_error_0_unscaled: 41.0000 (34.2738)  loss_ce_1_unscaled: 0.6678 (0.8868)  loss_bbox_1_unscaled: 0.4659 (0.5465)  loss_giou_1_unscaled: 1.7339 (1.6552)  cardinality_error_1_unscaled: 40.7500 (34.0357)  loss_ce_2_unscaled: 0.6594 (0.8300)  loss_bbox_2_unscaled: 0.4535 (0.5449)  loss_giou_2_unscaled: 1.7200 (1.6598)  cardinality_error_2_unscaled: 39.2500 (32.6905)  loss_ce_3_unscaled: 0.6807 (0.8332)  loss_bbox_3_unscaled: 0.4448 (0.5481)  loss_giou_3_unscaled: 1.7380 (1.6635)  cardinality_error_3_unscaled: 39.5000 (28.9167)  loss_ce_4_unscaled: 0.6884 (0.8459)  loss_bbox_4_unscaled: 0.4513 (0.5508)  loss_giou_4_unscaled: 1.7376 (1.6648)  cardinality_error_4_unscaled: 34.2500 (26.5833)  time: 0.4849  data: 0.0094  max mem: 3972
Epoch: [0]  [  30/3756]  eta: 0:30:31  lr: 0.001000  class_error: 0.00  loss: 36.3925 (39.8828)  loss_ce: 0.6609 (0.8060)  loss_bbox: 2.1911 (2.5630)  loss_giou: 3.4237 (3.3373)  loss_ce_0: 0.6496 (0.7795)  loss_bbox_0: 2.1035 (2.5846)  loss_giou_0: 3.4752 (3.3493)  loss_ce_1: 0.6402 (0.8126)  loss_bbox_1: 1.9994 (2.5001)  loss_giou_1: 3.3386 (3.2828)  loss_ce_2: 0.6581 (0.7747)  loss_bbox_2: 1.9900 (2.5197)  loss_giou_2: 3.3690 (3.2992)  loss_ce_3: 0.6616 (0.7787)  loss_bbox_3: 1.9875 (2.5347)  loss_giou_3: 3.4088 (3.3173)  loss_ce_4: 0.6583 (0.7861)  loss_bbox_4: 2.0248 (2.5489)  loss_giou_4: 3.3689 (3.3084)  loss_ce_unscaled: 0.6609 (0.8060)  class_error_unscaled: 0.0000 (26.0955)  loss_bbox_unscaled: 0.4382 (0.5126)  loss_giou_unscaled: 1.7119 (1.6686)  cardinality_error_unscaled: 39.5000 (31.1048)  loss_ce_0_unscaled: 0.6496 (0.7795)  loss_bbox_0_unscaled: 0.4207 (0.5169)  loss_giou_0_unscaled: 1.7376 (1.6746)  cardinality_error_0_unscaled: 41.0000 (35.1532)  loss_ce_1_unscaled: 0.6402 (0.8126)  loss_bbox_1_unscaled: 0.3999 (0.5000)  loss_giou_1_unscaled: 1.6693 (1.6414)  cardinality_error_1_unscaled: 41.7500 (36.4274)  loss_ce_2_unscaled: 0.6581 (0.7747)  loss_bbox_2_unscaled: 0.3980 (0.5039)  loss_giou_2_unscaled: 1.6845 (1.6496)  cardinality_error_2_unscaled: 39.5000 (34.2258)  loss_ce_3_unscaled: 0.6616 (0.7787)  loss_bbox_3_unscaled: 0.3975 (0.5069)  loss_giou_3_unscaled: 1.7044 (1.6586)  cardinality_error_3_unscaled: 40.0000 (33.0242)  loss_ce_4_unscaled: 0.6583 (0.7861)  loss_bbox_4_unscaled: 0.4050 (0.5098)  loss_giou_4_unscaled: 1.6845 (1.6542)  cardinality_error_4_unscaled: 39.5000 (31.4758)  time: 0.4770  data: 0.0092  max mem: 3972
Epoch: [0]  [  40/3756]  eta: 0:29:47  lr: 0.001000  class_error: 21.95  loss: 34.8441 (38.3931)  loss_ce: 0.6709 (0.7798)  loss_bbox: 1.8331 (2.3753)  loss_giou: 3.1821 (3.2674)  loss_ce_0: 0.6864 (0.7753)  loss_bbox_0: 1.9244 (2.3868)  loss_giou_0: 3.2277 (3.2873)  loss_ce_1: 0.6814 (0.7908)  loss_bbox_1: 1.8212 (2.3083)  loss_giou_1: 3.1335 (3.2369)  loss_ce_2: 0.6849 (0.7653)  loss_bbox_2: 1.9900 (2.3913)  loss_giou_2: 3.2182 (3.2647)  loss_ce_3: 0.6920 (0.7651)  loss_bbox_3: 1.8533 (2.3229)  loss_giou_3: 3.2340 (3.2439)  loss_ce_4: 0.6668 (0.7653)  loss_bbox_4: 1.9589 (2.3880)  loss_giou_4: 3.2228 (3.2785)  loss_ce_unscaled: 0.6709 (0.7798)  class_error_unscaled: 0.0000 (21.6263)  loss_bbox_unscaled: 0.3666 (0.4751)  loss_giou_unscaled: 1.5910 (1.6337)  cardinality_error_unscaled: 42.7500 (32.6159)  loss_ce_0_unscaled: 0.6864 (0.7753)  loss_bbox_0_unscaled: 0.3849 (0.4774)  loss_giou_0_unscaled: 1.6139 (1.6437)  cardinality_error_0_unscaled: 40.0000 (34.4634)  loss_ce_1_unscaled: 0.6814 (0.7908)  loss_bbox_1_unscaled: 0.3642 (0.4617)  loss_giou_1_unscaled: 1.5668 (1.6184)  cardinality_error_1_unscaled: 39.2500 (33.6646)  loss_ce_2_unscaled: 0.6849 (0.7653)  loss_bbox_2_unscaled: 0.3980 (0.4783)  loss_giou_2_unscaled: 1.6091 (1.6323)  cardinality_error_2_unscaled: 41.2500 (33.4329)  loss_ce_3_unscaled: 0.6920 (0.7651)  loss_bbox_3_unscaled: 0.3707 (0.4646)  loss_giou_3_unscaled: 1.6170 (1.6220)  cardinality_error_3_unscaled: 41.2500 (32.2012)  loss_ce_4_unscaled: 0.6668 (0.7653)  loss_bbox_4_unscaled: 0.3918 (0.4776)  loss_giou_4_unscaled: 1.6114 (1.6392)  cardinality_error_4_unscaled: 42.7500 (32.4878)  time: 0.4626  data: 0.0092  max mem: 3972
Epoch: [0]  [  50/3756]  eta: 0:29:41  lr: 0.001000  class_error: 0.00  loss: 31.1111 (36.9437)  loss_ce: 0.6708 (0.7555)  loss_bbox: 1.6204 (2.2131)  loss_giou: 3.0310 (3.2258)  loss_ce_0: 0.6864 (0.7524)  loss_bbox_0: 1.5953 (2.2327)  loss_giou_0: 3.0617 (3.2477)  loss_ce_1: 0.6798 (0.7630)  loss_bbox_1: 1.5795 (2.1409)  loss_giou_1: 2.9099 (3.1666)  loss_ce_2: 0.6697 (0.7414)  loss_bbox_2: 1.8186 (2.2608)  loss_giou_2: 3.0303 (3.2180)  loss_ce_3: 0.6825 (0.7440)  loss_bbox_3: 1.4707 (2.1415)  loss_giou_3: 2.8927 (3.1658)  loss_ce_4: 0.6646 (0.7426)  loss_bbox_4: 1.6097 (2.2201)  loss_giou_4: 3.0660 (3.2117)  loss_ce_unscaled: 0.6708 (0.7555)  class_error_unscaled: 0.0000 (17.3858)  loss_bbox_unscaled: 0.3241 (0.4426)  loss_giou_unscaled: 1.5155 (1.6129)  cardinality_error_unscaled: 41.7500 (34.3235)  loss_ce_0_unscaled: 0.6864 (0.7524)  loss_bbox_0_unscaled: 0.3191 (0.4465)  loss_giou_0_unscaled: 1.5308 (1.6239)  cardinality_error_0_unscaled: 41.7500 (35.0343)  loss_ce_1_unscaled: 0.6798 (0.7630)  loss_bbox_1_unscaled: 0.3159 (0.4282)  loss_giou_1_unscaled: 1.4550 (1.5833)  cardinality_error_1_unscaled: 38.5000 (35.0196)  loss_ce_2_unscaled: 0.6697 (0.7414)  loss_bbox_2_unscaled: 0.3637 (0.4522)  loss_giou_2_unscaled: 1.5152 (1.6090)  cardinality_error_2_unscaled: 41.7500 (34.5735)  loss_ce_3_unscaled: 0.6825 (0.7440)  loss_bbox_3_unscaled: 0.2941 (0.4283)  loss_giou_3_unscaled: 1.4464 (1.5829)  cardinality_error_3_unscaled: 41.2500 (33.6863)  loss_ce_4_unscaled: 0.6646 (0.7426)  loss_bbox_4_unscaled: 0.3219 (0.4440)  loss_giou_4_unscaled: 1.5330 (1.6059)  cardinality_error_4_unscaled: 41.7500 (34.2353)  time: 0.4641  data: 0.0091  max mem: 3972
Traceback (most recent call last):
  File "main.py", line 263, in <module>
    main(args)
  File "main.py", line 200, in main
    train_stats = train_one_epoch(
  File "/home/enricalvove/Desktop/detr_facebook/detr/engine.py", line 53, in train_one_epoch
    losses.backward()
  File "/home/enricalvove/environments/my_env/lib/python3.8/site-packages/torch/tensor.py", line 221, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/enricalvove/environments/my_env/lib/python3.8/site-packages/torch/autograd/__init__.py", line 130, in backward
    Variable._execution_engine.run_backward(
RuntimeError: CUDA out of memory. Tried to allocate 66.00 MiB (GPU 0; 5.80 GiB total capacity; 3.66 GiB already allocated; 19.62 MiB free; 4.35 GiB reserved in total by PyTorch)
